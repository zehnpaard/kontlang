(define coroutine
  (macro [expr]
    (fn []
      (reset
        (cons expr (fn [_] nil))))))

(define yield
  (letfn [yield [x]
    (shift [k] (cons x k))]
    yield))